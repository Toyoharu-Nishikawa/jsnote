
//backward functon Eq. (2.55) for region 3a on the page 97 in International Steam Tables pulished from Springer
//backward functon Eq. (2.56) for region 3b on the page 97 in International Steam Tables pulished from Springer

//3a
//Table 2.88
  const Ia = [] // lengthen is 34
  const Ja = [] // lengthen is 34
  const na = [] // lengthen is 34

  Ia[ 1]=  0;   Ja[ 1]=  0;   na[ 1]=  0.770889828326934e+1 ; 
  Ia[ 2]=  0;   Ja[ 2]=  1;   na[ 2]= -0.260835009128688e+2 ; 
  Ia[ 3]=  0;   Ja[ 3]=  5;   na[ 3]=  0.267416218930389e+3 ; 
  Ia[ 4]=  1;   Ja[ 4]=  0;   na[ 4]=  0.172221089496844e+2 ; 
  Ia[ 5]=  1;   Ja[ 5]=  3;   na[ 5]= -0.293542332145970e+3 ; 
  Ia[ 6]=  1;   Ja[ 6]=  4;   na[ 6]=  0.614135601882478e+3 ; 
  Ia[ 7]=  1;   Ja[ 7]=  8;   na[ 7]= -0.610562757725674e+5 ; 
  Ia[ 8]=  1;   Ja[ 8]= 14;   na[ 8]= -0.651272251118219e+8 ; 
  Ia[ 9]=  2;   Ja[ 9]=  6;   na[ 9]=  0.735919313521937e+5 ; 
  Ia[10]=  2;   Ja[10]= 16;   na[10]= -0.116646505914191e+11; 
  Ia[11]=  3;   Ja[11]=  0;   na[11]=  0.355267086434461e+2 ; 
  Ia[12]=  3;   Ja[12]=  2;   na[12]= -0.596144543825955e+3 ; 
  Ia[13]=  3;   Ja[13]=  3;   na[13]= -0.475842430145708e+3 ; 
  Ia[14]=  4;   Ja[14]=  0;   na[14]=  0.696781965359503e+2 ; 
  Ia[15]=  4;   Ja[15]=  1;   na[15]=  0.335674250377312e+3 ; 
  Ia[16]=  4;   Ja[16]=  4;   na[16]=  0.250526809130882e+5 ; 
  Ia[17]=  4;   Ja[17]=  5;   na[17]=  0.146997380630766e+6 ; 
  Ia[18]=  5;   Ja[18]= 28;   na[18]=  0.538069315091534e+20; 
  Ia[19]=  6;   Ja[19]= 28;   na[19]=  0.143619827291346e+22; 
  Ia[20]=  7;   Ja[20]= 24;   na[20]=  0.364985866165994e+20; 
  Ia[21]=  8;   Ja[21]=  1;   na[21]= -0.254741561156775e+4 ; 
  Ia[22]= 10;   Ja[22]= 32;   na[22]=  0.240120197096563e+28; 
  Ia[23]= 10;   Ja[23]= 36;   na[23]= -0.393847464679496e+30; 
  Ia[24]= 14;   Ja[24]= 22;   na[24]=  0.147073407024852e+25; 
  Ia[25]= 18;   Ja[25]= 28;   na[25]= -0.426391250432059e+32; 
  Ia[26]= 20;   Ja[26]= 36;   na[26]=  0.194509340621077e+39; 
  Ia[27]= 22;   Ja[27]= 16;   na[27]=  0.666212132114896e+24; 
  Ia[28]= 22;   Ja[28]= 28;   na[28]=  0.706777016552858e+34; 
  Ia[29]= 24;   Ja[29]= 36;   na[29]=  0.175563621975576e+42; 
  Ia[30]= 28;   Ja[30]= 16;   na[30]=  0.108408607429124e+29; 
  Ia[31]= 28;   Ja[31]= 36;   na[31]=  0.730872705175151e+44; 
  Ia[32]= 32;   Ja[32]= 10;   na[32]=  0.159145847398870e+25; 
  Ia[33]= 32;   Ja[33]= 28;   na[33]=  0.377121605943324e+41; 



//3b
//Table 2.89
  const Ib = [] // lengthen is 36
  const Jb = [] // lengthen is 36
  const nb = [] // lengthen is 36

  Ib[ 1]= -12;   Jb[ 1]=  2;   nb[ 1]=  0.125244360717979e-12 ; 
  Ib[ 2]= -12;   Jb[ 2]= 10;   nb[ 2]= -0.126599322553713e-1  ; 
  Ib[ 3]= -12;   Jb[ 3]= 12;   nb[ 3]=  0.506878030140626e+1  ; 
  Ib[ 4]= -12;   Jb[ 4]= 14;   nb[ 4]=  0.317847171154202e+2  ; 
  Ib[ 5]= -12;   Jb[ 5]= 20;   nb[ 5]= -0.391041161399932e+6  ; 
  Ib[ 6]= -10;   Jb[ 6]=  2;   nb[ 6]= -0.975733406392044e-10 ; 
  Ib[ 7]= -10;   Jb[ 7]= 10;   nb[ 7]= -0.186312419488279e+2  ; 
  Ib[ 8]= -10;   Jb[ 8]= 14;   nb[ 8]=  0.510973543414101e+3  ; 
  Ib[ 9]= -10;   Jb[ 9]= 18;   nb[ 9]=  0.373847005822362e+6  ; 
  Ib[10]=  -8;   Jb[10]=  2;   nb[10]=  0.299804024666572e-7  ; 
  Ib[11]=  -8;   Jb[11]=  8;   nb[11]=  0.200544393820342e+2  ; 
  Ib[12]=  -6;   Jb[12]=  2;   nb[12]= -0.498030487662829e-5  ; 
  Ib[13]=  -6;   Jb[13]=  6;   nb[13]= -0.102301806360030e+2  ; 
  Ib[14]=  -6;   Jb[14]=  7;   nb[14]=  0.552819126990325e+2  ; 
  Ib[15]=  -6;   Jb[15]=  8;   nb[15]= -0.206211367510878e+3  ; 
  Ib[16]=  -5;   Jb[16]= 10;   nb[16]= -0.794012232324823e+4  ; 
  Ib[17]=  -4;   Jb[17]=  4;   nb[17]=  0.782248472028153e+1  ; 
  Ib[18]=  -4;   Jb[18]=  5;   nb[18]= -0.586544326902468e+2  ; 
  Ib[19]=  -4;   Jb[19]=  8;   nb[19]=  0.355073647696481e+4  ; 
  Ib[20]=  -3;   Jb[20]=  1;   nb[20]= -0.115303107290162e-3  ; 
  Ib[21]=  -3;   Jb[21]=  3;   nb[21]= -0.175092403171802e+1  ; 
  Ib[22]=  -3;   Jb[22]=  5;   nb[22]=  0.257981687748160e+3  ; 
  Ib[23]=  -3;   Jb[23]=  6;   nb[23]= -0.727048374179467e+3  ; 
  Ib[24]=  -2;   Jb[24]=  0;   nb[24]=  0.121644822609198e-3  ; 
  Ib[25]=  -2;   Jb[25]=  1;   nb[25]=  0.393137871762692e-1  ; 
  Ib[26]=  -1;   Jb[26]=  0;   nb[26]=  0.704181005909296e-2  ; 
  Ib[27]=   0;   Jb[27]=  3;   nb[27]= -0.829108200698110e+2  ; 
  Ib[28]=   2;   Jb[28]=  0;   nb[28]= -0.265178818131250     ; 
  Ib[29]=   2;   Jb[29]=  1;   nb[29]=  0.137531682453991e+2  ; 
  Ib[30]=   5;   Jb[30]=  0;   nb[30]= -0.522394090753046e+2  ; 
  Ib[31]=   6;   Jb[31]=  1;   nb[31]=  0.240556298941048e+4  ; 
  Ib[32]=   8;   Jb[32]=  1;   nb[32]= -0.227361631268929e+5  ; 
  Ib[33]=  10;   Jb[33]=  1;   nb[33]=  0.890746343932567e+5  ; 
  Ib[34]=  14;   Jb[34]=  3;   nb[34]= -0.239234565822486e+8  ; 
  Ib[35]=  14;   Jb[35]=  7;   nb[35]=  0.568795808129714e+10 ; 

export const Back_3PHSa = (h, s) => {

  const P_ = 99 //[MPa] T*
  const h_ = 2300 //[kJ/kg] 
  const s_ = 4.4 //[kJ/(kgK)] 

  const eta0 = 1.01
  const sigma0 = 0.75 

  const etaPow = []
  const sigmaPow = []

  const eta = h/h_
  const sigma = s/s_

  const eta1 = eta - eta0
  const sigma1 = sigma - sigma0

  for(let i=1;i<=33;i++){
    etaPow[i] = Math.pow(eta1, Ia[i])
    sigmaPow[i] = Math.pow(sigma1, Ja[i])
  }

  let pai = 0
  for(let i=1;i<=33;i++){
    pai += na[i] * etaPow[i] * sigmaPow[i] 
  }
  const P = pai * P_

  return P 
}

export const Back_3PHSb = (h, s) => {

  const P_ = 16.6 //[MPa] T*
  const h_ = 2800 //[kJ/kg] 
  const s_ = 5.3 //[kJ/(kgK)] 

  const eta0 = 0.681 
  const sigma0 = 0.792 

  const etaPow = []
  const sigmaPow = []

  const eta = h/h_
  const sigma = s/s_

  const eta1 = eta - eta0
  const sigma1 = sigma - sigma0

  for(let i=1;i<=35;i++){
    etaPow[i] = Math.pow(eta1, Ib[i])
    sigmaPow[i] = Math.pow(sigma1, Jb[i])
  }

  let paiT = 0
  for(let i=1;i<=35;i++){
    paiT += nb[i] * etaPow[i] * sigmaPow[i] 
  }
  const P =  P_ /paiT

  return P 
}

